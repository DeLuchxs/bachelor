\chapter{Sicherheit}
\printmyminitoc{1}

\section{Schwachstellen}
Die durchgeführte Arbeit konnte in diesem Format nur durch einige Schwachstellen in der Kommunikation durchgeführt werden.
Um einen solchen Angriff möglichst zu vermeiden, ist es wichtig, dass die Schwachstellen aufgedeckt und behoben werden.
Dafür werden in dem folgenden Abschnitt die aufgedeckten Schwachstellen dieser Arbeit aufgeführt und diskutiert.

\subsection{Schwachstellen am CAN-Bus}
Der CAN-Bus ist eines der zentralen Systeme in modernen Fahrzeugen und Schiffen. So auch auf der Limanda.
Nach dem CAN-Standard sind die Nachrichten auf dem Bus nicht verschlüsselt. Zusätzlich werden die Nachrichten nur 
auf ihre Richtigkeit überprüft, jedoch nicht auf ihre Authentizität. Das bedeutet, dass ein Angreifer Nachrichten auf den Bus
senden kann, die von anderen Systemen als legitim angesehen werden.\cite{Voss2008} (Seiten 13-19) Durch das Bus-Netzwerk wird die einfache Integration weiterer
Geräte in das System ermöglicht. Ein Angreifer kann so durch physischen Zugriff auf den Bus ein Gerät hinzufügen, welches im schlimmsten Fall
die Kontrolle über das gesamte System übernehmen kann. Die einzige Hürde, ein Gerät in ein CAN-Bus Netzwerk zu integrieren, ist das
Beschaffen der richtigen DBC-Datei. Diese Datei wird häufig von den Herstellern der Geräte nicht öffentlich zur Verfügung gestellt.
Es sind jedoch einige DBC-Dateien im Internet verfügbar, die von anderen Nutzern erstellt wurden. Durch das Ausprobieren von dem Dekodieren
der CAN-Nachrichten mit verschiedenen DBC-Dateien, kann eine passende Datei gefunden werden. \\
In dieser Arbeit wurde zuerst ausgenutzt, dass die Nachrichten durch physischen Zugriff auf den Bus mitgelesen werden können.
Die Nachrichten wurden aufgezeichnet und mit einer passenden DBC-Datei dekodiert. Nachdem die Nachrichten verstanden wurden, konnte
eine Nachricht mit dem gleichen Syntax und eigenen Werten erstellt werden. Die aufgezeichnete Nachrichten-ID wurde dabei in der Quelle 
verändert. Die Priorität ist gleich geblieben, da es bereits die höchste Priorität war. In anderen Fällen ist es möglich, die Priorität
einfach zu verändern. Mit der eigenen Nachrichten-ID konnten nun die 
echten Nachrichten von den eigenen unterschieden werden. Das ist wichtig, um echte Nachrichten mit den eigenen zu überschreiben. 
Alle Geräte in einem CAN-Bus sind gleichberechtigt\cite{Voss2008} (Seite 14). Dadurch wird die Überschreibung der älteren Nachrichten möglich.\\
Die vorher beschriebenen Schwachstellen sind allgemein für CAN-Bus Netzwerke. Wobei nicht alle eine Schwachstelle beschreiben, sondern 
Eigenschaften des Standards sind, welche zusammen mit den Schwachstellen ausgenutzt werden können.\\

\subsection{Schwachstellen am J1939-Protokoll}
Das J1939-Protokoll ist ein Protokoll, welches nicht für die Sicherheit, sondern für die Kommunikation zwischen den Steuergeräten
entwickelt wurde. Es ist ein Protokoll, welches auf dem CAN-Bus aufbaut. Das Protokoll ist nicht verschlüsselt und die Nachrichten
sind nicht authentifiziert. 
Allerdings hat das Protokoll auch spezifische Schwachstellen, welche aber nicht alle in dieser Arbeit ausgenutzt wurden.\\
Eine Schwachstelle ist, dass Nachrichten mit der niedrigsten ID die höchste Priorität haben. Zusätzlich ist es möglich, 
eine eigene Priorität so zu setzen, dass die Nachrichten mit der eigenen ID die höchste Priorität haben. Durch das Senden von
vielen Nachrichten mit hoher Priorität kann ein Denial-of-Service-Angriff durchgeführt werden. Dabei wird der Bus so stark belastet,
dass die echten Nachrichten nicht in einem angemessenen Zeitraum gesendet werden können. Jedes Gerät in einem J1939-Netzwerk
benötigt eine eindeutige Adresse und einen einzigartigen Namen \cite{JungerJ1939}. Da ein Gerät vollständige Kontrolle über 
den eigenen Namen und die eigene Adresse hat, kann ein Angreifer sich als ein anderes Gerät ausgeben. Die Namensübernahme führt
zunächst zu einem Konflikt, da zwei Geräte den gleichen Namen haben. Diesen Konflikt gewinnt das Gerät, welches die niedrigere
Adresse hat. Daher kann der Name recht einfach übernommen werden. Dadurch kann ein originelles Gerät aus dem Netzwerk ausgeschlossen
werden. Mit der übernommenen Adresse kann der Angreifer nun Nachrichten senden, die von anderen Geräten als legitim angesehen werden.
Die einzige Sicherheitsmaßnahme, die das J1939-Protokoll bietet, ist eine Zuweisungstabelle für die Adressen und Namen. Allerdings
bietet diese bei der Namensübernahme keinen Schutz, wenn der Angreifer auch die Adresse übernimmt. Diese Schwachstelle 
wurde in dieser Arbeit nicht ausgenutzt, da es zu unvorhersehbaren Folgen hätte führen können. Das spricht für die 
Schwere der Schwachstelle.\\
Eine weitere Möglichkeit den Bus zu stören, ist die globale Anfrage nach PGNs. Bei einer solchen Anfrage sollen alle Geräte
mit der eigenen PGN antworten. Die Spezifikation rät dazu, maximal 3 Anfragen pro Sekunde für eine Parametergruppe zu senden.
Es gibt aber keine feste obere Grenze für die Anzahl der Anfragen. Daher gibt es auch keine Gegenmaßnahmen bei zu vielen 
Anfragen. Ein Angreifer kann also durch das Senden von vielen Anfragen alle Geräte auf dem Bus dazu bringen, zu antworten.
Damit ist ein Distributed-Denial-of-Service-Angriff (DDoS) möglich, weil die Überlastung von mehreren Geräten ausgeht. \\
\cite{Murvay2018}

\subsection{Schwachstellen an der Rudersteuerung}
Die Rudersteuerung wird nur durch das physikalische Steuerrad oder den Autopiloten gesteuert. Da ein physikalischer
Angriff auf das Steuerrad nicht verdeckt durchgeführt werden kann, werden keine außerordentlichen Schutzmaßnahmen benötigt.
Bei dem Autopiloten von Navitron handelt es sich um ein Gerät, welches Informationen zu dem Kurs, Geschwindigkeit und
Position des Schiffes über den NMEA-0183-Bus erhält. Durch die Eigenschaft, dass NMEA-0183 direkt mit ASCII-Nachrichten
arbeitet, ist es möglich mit physikalischem Zugriff auf den Bus Nachrichten zu lesen. \cite{nmea0183} (letzter Zugriff 07.03.2025) \\
Diese können zur Überwachung oder auch späteren Manipulation der Kommunikation genutzt werden. Mit aufgezeichneten Nachrichten
kann ein Angreifer die Kommunikation von den Sensoren zu dem Autopiloten nachvolziehen. Durch das Senden von eigenen Nachrichten
könnte es möglich, den Autopiloten indirekt zu steuern. Das könnte durch eine Manipulation der Kursdaten mittels einer Man-in-the-Middle-Attacke
erreicht werden. Dies wurde in dieser Arbeit aber nicht getestet und ist daher nur eine Annahme. 
NMEA-0183 unterstützt eine Baudrate von 4800. Das bedeutet, dass die Nachrichten mit einer Geschwindigkeit von 9600 Bit pro Sekunde
gesendet werden. Dadurch können Geräte mit diesem Standard möglicherweise durch eine Denial-of-Service-Attacke gestört werden.
\cite{Tran2021}
Der Autopilot sendet basierend auf den Kursdaten und den eigenen Einstellungen Nachrichten an die Rudersteuerung. Für diese 
Nachrichten wurde im Rahmen dieser Arbeit keine Verschlüsselung festgestellt. Aber der Standard dieser Nachrichten ist nicht
bekannt. Das stellt zwar keine Sicherheitsmaßnahme dar, aber es ist eine Hürde für einen Angreifer. Wenn jedoch 
der Standard bekannt ist, kann ein Angreifer die Nachrichten zumindest mitlesen. Eine Authentifizierung wurde auch
nicht festgestellt, aber es kann nicht ausgeschlossen werden, dass eine Authentifizierung stattfindet.\\

\section{Schutzmaßnahmen}
Schutzmaßnahmen sind notwendig, um die Schwachstellen zu schließen und Angriffe zu verhindern.
Eine Schwierigkeit bei dem Zugriff auf den CAN-Bus ist, dass dieser physisch zugänglich sein muss. Dies ist auch auf der Limanda
der Fall. Wenn man allerdings unbemerkten Zugriff erhält, kann das Rogue Device versteckt in dem System integriert werden. 
Das stellt die einzige Schutzmaßnahme dar, die in dieser Arbeit umgangen wurde. Jedoch wird der Zugriff nur durch eine Abdeckung zu der Technik des Schiffes
verhindert. Mit dem richtigen Werkzeug kann diese Abdeckung einfach entfernt werden.
Eine weitere Hürde ist, dass die richtige Baudrate für den CAN-Bus des Schiffes gewählt werden muss. Ohne vorherige Kenntnisse
muss dabei ausprobiert werden, welche Baudrate die richtige ist. Das stellt aber keine Schutzmaßnahme dar, sondern einfach
eine wichtige Eigenschaft des CAN-Standards.\\

Was sind weitere Möglichkeiten?
\begin{itemize}
    \item Intrusion Detection Systeme (IDS) für den CAN-Bus
    \item Dabei muss der CAN-Standard in keiner Form modifiziert werden
    \item auch keine Implementation in jedem Gerät eines Netzwerkes notwendig
\end{itemize}
\cite{Gmiden2016}
\begin{itemize}
    \item zwei Arten von IDS für den CAN-Bus
    \item Signatur/Regel basiertes Detektionssystem
    \item dabei sind werden gewisse Kombinationen oder Seqeunzen von Nachrichten von bekannten Angriffen erkannt
    \item Anomalie basiertes Detektionssystem
    \item dabei wird das normale Verhalten des Systems überwacht
    \item Abweichungen von diesem Verhalten werden als Angriff erkannt, eigene Lösung für Schiffe notwendig, da unterschiedliches Verhalten
    \item Studie dazu \cite{Davieds2024}
    \item Anomalie basiertes System weniger wartungsintensiv, da keine ständige Aktualisierung der Regeln notwendig um neue Angriffe zu erkennen
    \item Anomalie basiertes System auch besser für unbekannte Angriffe, aber auch mehr Fehlalarme
    \item Regeln basiertes System sehr zuverlässig für bekannte Angriffe
\end{itemize}
\cite{Hoppe2009}

\begin{itemize}
    \item probleme mit J1939 vorallem durch das Fehlen kryptographischer Authentifizierung
    \item aufgrund der verschiedenen Hersteller ist es schwierig, eine einheitliche Lösung zu finden
    \item daher public key infrastructure (PKI) notwendig
\end{itemize}
\cite{Murvay2018}
Feasability of PKI in J1939:
\begin{itemize}
    \item notwendigkeit von PKI in Fahrzeug-Fahrzeug Netzwerken
    \item Support für PKI in AUTOSAR (Automotive Open System Architecture) crypographic specification
    \item viele Open-Source libraries mit PKI support
    \item zumindest für Autoindustrie keine ungewöhnliche Forderung, schon einige Implementierungen mit PKI
\end{itemize}
\cite{Murvay2018}
\section{Relevanz für andere Schiffe}
Gibt es solche Angriffsmöglichkeiten auch auf anderen Schiffen?
\begin{itemize}
    \item Can-Bus häufig genutzt, häufig nicht authentifizierte nachrichten
    \item besonders auf größeren Schiffen ist das Ruder nicht mehr mechanisch, sondern elektronisch
    \item Angriff auf das Steuerungssystem könnte katastrophale Folgen haben
\end{itemize}