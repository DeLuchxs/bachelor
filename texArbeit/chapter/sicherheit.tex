\chapter{Sicherheit}
\printmyminitoc{1}

\section{Schwachstellen}
Die durchgeführte Arbeit konnte in diesem Format nur durch einige Schwachstellen in der Kommunikation durchgeführt werden.
Um einen solchen Angriff möglichst zu vermeiden, ist es wichtig, dass die Schwachstellen aufgedeckt und behoben werden.
Dafür werden in dem folgenden Abschnitt die aufgedeckten Schwachstellen dieser Arbeit aufgeführt und diskutiert.

\subsection{Schwachstellen am CAN-Bus}
Der CAN-Bus ist eines der zentralen Systeme in modernen Fahrzeugen und Schiffen. So auch auf der Limanda.
Nach dem CAN-Standard sind die Nachrichten auf dem Bus nicht verschlüsselt. Zusätzlich werden die Nachrichten nur 
auf ihre Richtigkeit überprüft, jedoch nicht auf ihre Authentizität. Das bedeutet, dass ein Angreifer Nachrichten auf den Bus
senden kann, die von anderen Systemen als legitim angesehen werden.\cite{Voss2008} (Seiten 13-19) Durch das Bus-Netzwerk wird die einfache Integration weiterer
Geräte in das System ermöglicht. Ein Angreifer kann so durch physischen Zugriff auf den Bus ein Gerät hinzufügen, welches im schlimmsten Fall
die Kontrolle über das gesamte System übernehmen kann. Die einzige Hürde, ein Gerät in ein CAN-Bus Netzwerk zu integrieren, ist das
Beschaffen der richtigen DBC-Datei. Diese Datei wird häufig von den Herstellern der Geräte nicht öffentlich zur Verfügung gestellt.
Es sind jedoch einige DBC-Dateien im Internet verfügbar, die von anderen Nutzern erstellt wurden. Durch das Ausprobieren von dem Dekodieren
der CAN-Nachrichten mit verschiedenen DBC-Dateien, kann eine passende Datei gefunden werden. \\
In dieser Arbeit wurde zuerst ausgenutzt, dass die Nachrichten durch physischen Zugriff auf den Bus mitgelesen werden können.
Die Nachrichten wurden aufgezeichnet und mit einer passenden DBC-Datei dekodiert. Nachdem die Nachrichten verstanden wurden, konnte
eine Nachricht mit dem gleichen Syntax und eigenen Werten erstellt werden. Die aufgezeichnete Nachrichten-ID wurde dabei in der Quelle 
verändert. Die Priorität ist gleich geblieben, da es bereits die höchste Priorität war. In anderen Fällen ist es möglich, die Priorität
einfach zu verändern. Mit der eigenen Nachrichten-ID konnten nun die 
echten Nachrichten von den eigenen unterschieden werden. Das ist wichtig, um echte Nachrichten mit den eigenen zu überschreiben. 
Alle Geräte in einem CAN-Bus sind gleichberechtigt\cite{Voss2008} (Seite 14). Dadurch wird die Überschreibung der älteren Nachrichten möglich.\\
Die vorher beschriebenen Schwachstellen sind allgemein für CAN-Bus Netzwerke. Wobei nicht alle eine Schwachstelle beschreiben, sondern 
Eigenschaften des Standards sind, welche zusammen mit den Schwachstellen ausgenutzt werden können.\\

\subsection{Schwachstellen am J1939-Protokoll}
Das J1939-Protokoll ist ein Protokoll, welches nicht für die Sicherheit, sondern für die Kommunikation zwischen den Steuergeräten
entwickelt wurde. Es ist ein Protokoll, welches auf dem CAN-Bus aufbaut. Das Protokoll ist nicht verschlüsselt und die Nachrichten
sind nicht authentifiziert. 
Allerdings hat das Protokoll auch spezifische Schwachstellen, welche aber nicht alle in dieser Arbeit ausgenutzt wurden.\\
Eine Schwachstelle ist, dass Nachrichten mit der niedrigsten ID die höchste Priorität haben. Zusätzlich ist es möglich, 
eine eigene Priorität so zu setzen, dass die Nachrichten mit der eigenen ID die höchste Priorität haben. Durch das Senden von
vielen Nachrichten mit hoher Priorität kann ein Denial-of-Service-Angriff durchgeführt werden. Dabei wird der Bus so stark belastet,
dass die echten Nachrichten nicht in einem angemessenen Zeitraum gesendet werden können. Ein weiterer Angriff ist das Übernehmen
einer Adresse. Jedes Gerät im J1939-Netzwerk hat eine eindeutige Adresse. Diese Adresse wird von den anderen Geräten genutzt, um
Nachrichten an das Gerät zu senden. 

Spezifische Schwachstellen für J1939:
\begin{itemize}
    \item Es ist möglich, ein Node in das Netzwerk hinzuzufügen, welcher seinen NAME, Adresse ändern kann und vollständige Kontrolle über alles veränderbaren Felder hat (CANoe)
    \item Angreifer-Node kann später hinzugefügt werden und dann eine schon vorhandene Adresse übernehmen, durch ein NAME-field mit niedrigerem Wert und somit höherer Priorität
    \item ständig diesen ehrlichen Knoten zu stören eine Adresse zu erlangen kann diesen komplett aus der Kommunikation ausschließen
\end{itemize}
Sicherheitsmaßnahme von J1939:
Es gibt eine Zuweisungstabelle für Adresse-zu-NAME correspondence, welche jedoch einfach umgangen werden
kann, durch das deklarieren des gleichen NAME wie der gezielte Knoten, jedoch mit einer niedrigeren ID
um eine höhere Priorität zu erhalten und die Adresszuweisung zu gewinnen.
\begin{itemize}
    \item Angreifer kann sich als ein anderer Knoten ausgeben und so falsche, bösartige Nachrichten senden
    \item bei einer globalen Anfrage nach PGNs sollte jeder Knoten antworten
    \begin{itemize}
        \item Spezifikation rät dazu, maximal 3 Anfragen pro Sekunde für eine Parametergruppe
        \item keine Gegenmaßnahmen gegen mehr Anfragen
        \item somit kann ein DDoS Angriff durchgeführt werden (alle Knoten antworten bei einer Anfrage)
    \end{itemize}
\end{itemize}

\cite{Murvay2018}

\section{Schutzmaßnahmen}
Welche gibt es bereits?
\begin{itemize}
    \item richtige Baudrate muss eingestellt sein (keine wirkliche Schutzmaßnahme)
    \item keine dedizierten Schutzmaßnahmen auf dem Forschungsschiff
\end{itemize}
Was sind weitere Möglichkeiten?
\begin{itemize}
    \item Verschlüsselung der Kommunikation
    \item Authentifizierung der Nachrichten
    \item Überwachung der Kommunikation
    \item regelmäßige Überprüfung der Kommunikation
    \item Auf größeren Schiffen: Trennung der Passagiernetzwerke von den Steuerungssystemen
\end{itemize}

\section{Relevanz für andere Schiffe}
Gibt es solche Angriffsmöglichkeiten auch auf anderen Schiffen?
\begin{itemize}
    \item Can-Bus häufig genutzt, häufig unverschlüsselt
    \item besonders auf größeren Schiffen ist das Ruder nicht mehr mechanisch, sondern elektronisch
    \item Angriff auf das Steuerungssystem könnte katastrophale Folgen haben
\end{itemize}