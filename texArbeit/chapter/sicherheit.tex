\chapter{Sicherheit}
\printmyminitoc{1}

\section{Schwachstellen}
Die durchgeführte Arbeit konnte in diesem Format nur durch einige Schwachstellen in der Kommunikation durchgeführt werden.
Um einen solchen Angriff möglichst zu vermeiden, ist es wichtig, dass die Schwachstellen aufgedeckt und behoben werden.
Dafür werden in dem folgenden Abschnitt die aufgedeckten Schwachstellen dieser Arbeit aufgeführt und diskutiert.

\subsection{Schwachstellen am CAN-Bus}
Der CAN-Bus ist eines der zentralen Systeme in modernen Fahrzeugen und Schiffen. So auch auf der Limanda.
Nach dem CAN-Standard sind die Nachrichten auf dem Bus nicht verschlüsselt. Zusätzlich werden die Nachrichten nur 
auf ihre Richtigkeit überprüft, jedoch nicht auf ihre Authentizität. Das bedeutet, dass ein Angreifer Nachrichten auf den Bus
senden kann, die von anderen Systemen als legitim angesehen werden.\cite{Voss2008} (Seiten 13-19) Durch das Bus-Netzwerk wird die einfache Integration weiterer
Geräte in das System ermöglicht. Ein Angreifer kann so durch physischen Zugriff auf den Bus ein Gerät hinzufügen, welches im schlimmsten Fall
die Kontrolle über das gesamte System übernehmen kann. Die einzige Hürde, ein Gerät in ein CAN-Bus Netzwerk zu integrieren, ist das
Beschaffen der richtigen DBC-Datei. Diese Datei wird häufig von den Herstellern der Geräte nicht öffentlich zur Verfügung gestellt.
Es sind jedoch einige DBC-Dateien im Internet verfügbar, die von anderen Nutzern erstellt wurden. Durch das Ausprobieren von dem Dekodieren
der CAN-Nachrichten mit verschiedenen DBC-Dateien, kann eine passende Datei gefunden werden. \\
In dieser Arbeit wurde zuerst ausgenutzt, dass die Nachrichten durch physischen Zugriff auf den Bus mitgelesen werden können.
Die Nachrichten wurden aufgezeichnet und mit einer passenden DBC-Datei dekodiert. Nachdem die Nachrichten verstanden wurden, konnte
eine Nachricht mit dem gleichen Syntax und eigenen Werten erstellt werden. Die aufgezeichnete Nachrichten-ID wurde dabei in der Quelle 
verändert. Die Priorität ist gleich geblieben, da es bereits die höchste Priorität war. In anderen Fällen ist es möglich, die Priorität
einfach zu verändern. Mit der eigenen Nachrichten-ID konnten nun die 
echten Nachrichten von den eigenen unterschieden werden. Das ist wichtig, um echte Nachrichten mit den eigenen zu überschreiben. 
Alle Geräte in einem CAN-Bus sind gleichberechtigt\cite{Voss2008} (Seite 14). Dadurch wird die Überschreibung der älteren Nachrichten möglich.\\
Die vorher beschriebenen Schwachstellen sind allgemein für CAN-Bus Netzwerke. Wobei nicht alle eine Schwachstelle beschreiben, sondern 
Eigenschaften des Standards sind, welche zusammen mit den Schwachstellen ausgenutzt werden können.\\

\subsection{Schwachstellen am J1939-Protokoll}
Das J1939-Protokoll ist ein Protokoll, welches nicht für die Sicherheit, sondern für die Kommunikation zwischen den Steuergeräten
entwickelt wurde. Es ist ein Protokoll, welches auf dem CAN-Bus aufbaut. Das Protokoll ist nicht verschlüsselt und die Nachrichten
sind nicht authentifiziert. 
Allerdings hat das Protokoll auch spezifische Schwachstellen, welche aber nicht alle in dieser Arbeit ausgenutzt wurden.\\
Eine Schwachstelle ist, dass Nachrichten mit der niedrigsten ID die höchste Priorität haben. Zusätzlich ist es möglich, 
eine eigene Priorität so zu setzen, dass die Nachrichten mit der eigenen ID die höchste Priorität haben. Durch das Senden von
vielen Nachrichten mit hoher Priorität kann ein Denial-of-Service-Angriff durchgeführt werden. Dabei wird der Bus so stark belastet,
dass die echten Nachrichten nicht in einem angemessenen Zeitraum gesendet werden können. Jedes Gerät in einem J1939-Netzwerk
benötigt eine eindeutige Adresse und einen einzigartigen Namen \cite{JungerJ1939}. Da ein Gerät vollständige Kontrolle über 
den eigenen Namen und die eigene Adresse hat, kann ein Angreifer sich als ein anderes Gerät ausgeben. Die Namensübernahme führt
zunächst zu einem Konflikt, da zwei Geräte den gleichen Namen haben. Diesen Konflikt gewinnt das Gerät, welches die niedrigere
Adresse hat. Daher kann der Name recht einfach übernommen werden. Dadurch kann ein originelles Gerät aus dem Netzwerk ausgeschlossen
werden. Mit der übernommenen Adresse kann der Angreifer nun Nachrichten senden, die von anderen Geräten als legitim angesehen werden.
Die einzige Sicherheitsmaßnahme, die das J1939-Protokoll bietet, ist eine Zuweisungstabelle für die Adressen und Namen. Allerdings
bietet diese bei der Namensübernahme keinen Schutz, wenn der Angreifer auch die Adresse übernimmt. Diese Schwachstelle 
wurde in dieser Arbeit nicht ausgenutzt, da es zu unvorhersehbaren Folgen hätte führen können. Das spricht für die 
Schwere der Schwachstelle.\\
Eine weitere Möglichkeit den Bus zu stören, ist die globale Anfrage nach PGNs. Bei einer solchen Anfrage sollen alle Geräte
mit der eigenen PGN antworten. Die Spezifikation rät dazu, maximal 3 Anfragen pro Sekunde für eine Parametergruppe zu senden.
Es gibt aber keine feste obere Grenze für die Anzahl der Anfragen. Daher gibt es auch keine Gegenmaßnahmen bei zu vielen 
Anfragen. Ein Angreifer kann also durch das Senden von vielen Anfragen alle Geräte auf dem Bus dazu bringen, zu antworten.
Damit ist ein Distributed-Denial-of-Service-Angriff (DDoS) möglich, weil die Überlastung von mehreren Geräten ausgeht. \\
\cite{Murvay2018}


\section{Schutzmaßnahmen}
Welche gibt es bereits?
\begin{itemize}
    \item richtige Baudrate muss eingestellt sein (keine wirkliche Schutzmaßnahme)
    \item keine dedizierten Schutzmaßnahmen auf dem Forschungsschiff
\end{itemize}
Was sind weitere Möglichkeiten?
\begin{itemize}
    \item Verschlüsselung der Kommunikation
    \item Authentifizierung der Nachrichten
    \item Überwachung der Kommunikation
    \item regelmäßige Überprüfung der Kommunikation
    \item Auf größeren Schiffen: Trennung der Passagiernetzwerke von den Steuerungssystemen
\end{itemize}

\section{Relevanz für andere Schiffe}
Gibt es solche Angriffsmöglichkeiten auch auf anderen Schiffen?
\begin{itemize}
    \item Can-Bus häufig genutzt, häufig unverschlüsselt
    \item besonders auf größeren Schiffen ist das Ruder nicht mehr mechanisch, sondern elektronisch
    \item Angriff auf das Steuerungssystem könnte katastrophale Folgen haben
\end{itemize}